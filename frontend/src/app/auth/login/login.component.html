<section class="login">
  <!-- Title and Intro -->
  <h2><b>Welcome</b></h2>
  <p>To access <span class="logo-font"><b>Chatwords</b></span> you must authenticate first.</p>

  <!-- Login Form -->
  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">

    <!-- Email Field and its Error Handling -->
    <div class="form-group">
      <label for="email">Email</label>
      <input
        class="form-control"
        [ngClass]="{'is-invalid': submitted() && (isFieldInvalid('email', 'required') || isFieldInvalid('email', 'email'))}"
        type="email"
        id="email"
        formControlName="email"
        autocomplete="email"
        placeholder="Introduce your email"
      >
      @if (submitted() && isFieldInvalid('email', 'required')) {
        <small class="text-danger error-message">Email is required</small>
      }
      @if (submitted() && isFieldInvalid('email', 'email')) {
        <small class="text-danger error-message">Please enter a valid email address.</small>
      }
    </div> 
    
    <!-- Password Field and its Error Handling -->
    <div class="form-group">
      <label for="password">Password</label>
      <div class="password-input-container">
        <input
          class="form-control"
          [ngClass]="{'is-invalid': submitted() && isFieldInvalid('password', 'required')}"
          [type]="showPassword ? 'text' : 'password'"
          id="password"
          formControlName="password"
          placeholder="Introduce your password"
        >
        <button 
          type="button" 
          class="btn btn-outline-secondary password-toggle-btn"
          (click)="togglePasswordVisibility()"
          aria-label="Toggle password visibility"
        >
          <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
        </button>
      </div>
      @if (submitted() && isFieldInvalid('password', 'required')) {
        <small class="text-danger error-message">Password is required</small>
      }
    </div> 
    
    <!-- Submit and general Error Handling -->
    <button type="submit" class="btn btn-secondary btn-login" [disabled]="loading()">
      @if (loading()) {
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> 
        Logging in...
      } @else {
        Login
      }
    </button>

    @if (loginError) {
      <small class="text-danger error-message">{{ loginError }}</small>
    }
  </form>

  <!-- Register Link -->
  <div class="register-link">
    Don't have an account?
    <a routerLink="/create-account">Sign up here</a>
  </div>
</section>